# round 589, div 2

## A

初看是个数位dp，定睛一看r只有1e5，所以暴枚ans，检测它能否满足即可。

如果r有1e9，那就全排列呗，3628800，3e6，可以的。

## B

把确定的格子标一下，数不确定的格子数就好了。

菜鸡没有看到第二个样例以为题目必然合法WA了一发。

## C

简单推一推，发现f中各个素数可以分开考虑，而对于每个素数可以$log_p\ n$算出答案（吸取了校赛B的教训），这样看来复杂度为$O(\sqrt x + T log\ n), T = 10 = O(\sqrt x)$。

菜鸡sqrt取了小于号而不是等于号就没了，分数-500（算上非显性的可能更多）。

## D

智商题一道。

注意到两个相同集合中的点必然无边而两个不同集合中的点必然连边。所以可以随便选一点，给他染红色，那么没和它相连的点都是红色的，和它相连的点都是蓝色或绿色。那就在剩下的点里随便选一点，重复上述操作，就能确定所有点的颜色情况了。

接着只要确定合法性就好了。首先$m = sz_1 * sz_2 + sz_1 * sz_3 + sz_2 * sz_3$，这是容易看出来的性质，也容易看出点集颜色确定后如何相同点集中任意点没有连边这样子边数最大。于是接着判一判相同点集中是否任意点均无连边就好了。

需要注意的是，还要判定$sz_1, sz_2, sz_3$均为正。没判这个喜WA3，幸好看了看发现了这个问题。

## E

不会dp。

容斥原理，考虑这个题目中哪些东西容易求：全部方案数好求，某行某列必然不合法的方案数好求。

于是考虑枚举必然不合法的行列数，容斥原理搞一搞。

在容斥原理的式子中r和c是完全等价的，故无需在乎二者间的相互作用？

推出一个$n^2$项的式子后可以固定必然不合法的行数后必然不合法的列数可以化成一项而无需枚举，然后式子就只有$n$项了，复杂度$O(nlog\ n)$。

（但是并不清楚这样枚举的意义所在orz，只会暴力推式子。

## F

巨烦，不是很想做。

